% ------------------------------------------------------------------------------
% This set of commands define the path test-output/factory the amber driver
% produces as it process YAML files.
% ------------------------------------------------------------------------------
\newcommand{\testOutputDir}{test-output}
\newcommand{\tofPath}{\testOutputDir}
\newcommand{\tofPathC}{\testOutputDir}

\newcommand{\setTOFPath}{\renewcommand{\testOutputDir}{test-output/factory}}
\newcommand{\setTOFPathC}[2]{\renewcommand{\testOutputDir}{test-output/#1/#2/factory}}

\newcommand{\tcPath}{}
\newcommand{\tcLog}{}
\newcommand{\tcPng}{}
\newcommand{\tcCsv}{}

\newcommand{\tcPathC}{}
\newcommand{\tcLogC}{}
\newcommand{\tcPngC}{}
\newcommand{\tcCsvC}{}
\newcounter{FileCnt}\setcounter{FileCnt}{1}
\newboolean{MoreFiles}\setboolean{MoreFiles}{true}

% ------------------------------------------------------------------------------
% Comma Separated Variable table definition.  This table is applicable to 1 and
% 3 argument commands.
% ------------------------------------------------------------------------------
% Define column names use by csvreader for Test Case results.
\csvnames{tcNames}{1=\id, 2=\key, 3=\des, 4=\status}

% Define a table style for Test Case results.
\csvstyle{tcStyle}{
  longtable=|L{1.7cm}|L{5cm}|L{7cm}|C{1.3cm}|
  ,table head=\hline REQID & RESKEY & TEXT & STATUS\\\hline\hline\endhead
  ,late after line=\\\hline
  ,tcNames
}

% ------------------------------------------------------------------------------
% These commands are used when the amber driver is directed to run a Test Plan,
% Test Suite, or Test Case that does not provide support for a web browser or
% spoken language.
%
% Test Plan, Test Suite, and Test Case one argument commands:
% #1 - filename
% ------------------------------------------------------------------------------
% Define Test Plan Output (tpo) commands.
\newcommand{\tpo}[1]{\setTOFPath\inputIfExists{\tofPath/plan/#1/#1.tex}}

% ------------------------------------------------------------------------------
% Define Test Suite Output (tso) commands.
\newcommand{\tso}[1]{\setTOFPath\inputIfExists{\tofPath/suite/#1/#1.tex}}

% ------------------------------------------------------------------------------
% Define Test Case Output (tco) commands.
%
% Define a command to standardize test case output (tco).
\newcommand{\tco}[1]{
  %
  \setTOFPath
  %
  \renewcommand{\tcPath}{\tofPath/case}
  \renewcommand{\tcLog}{\tcPath/#1/#1.tex}
  \renewcommand{\tcPng}{\tcPath/#1/#1.png}
  \renewcommand{\tcCsv}{\tcPath/#1/#1.csv}
  %
  \inputIfExists{\tcLog}
  %
  \IfFileExists{\tcPng}{
    \begin{figure}[ht]
      \centering
      \includegraphics[scale=0.25]{\tcPng}
      \caption{#1 Page}
    \end{figure}
  }
  {}
  %
  \IfFileExists{\tcCsv}{
  	\csvreader[tcStyle, separator=pipe]
  	{\tcCsv}{}{\id & \key & \des & \status}
  }
  {}
}
% ------------------------------------------------------------------------------
% These commands are used when the amber driver is directed to run a Test Plan,
% Test Suite, or Test Case to support a web browser and spoken language.
%
% Test Plan, Test Suite, and Test Case three argument commands:
% #1 - browser
% #2 - language
% #3 - filename
% ------------------------------------------------------------------------------
% Define Test Plan Output (tpo) commands.
\newcommand{\tpoC}[3]{\setTOFPathC{#1}{#2}\input{\tofPathC/plan/#3/#3.tex}}

% ------------------------------------------------------------------------------
% Define Test Suite Output (tso3) commands.
\newcommand{\tsoC}[3]{\setTOFPathC{#1}{#2}\input{\tofPathC/suite/#3/#3.tex}}

% ------------------------------------------------------------------------------
% Zero fill numbers
\newcommand{\zerofill}[1]{\ifnum#1<10 00#1\else\ifnum#1<100 0#1\else #1\fi\fi}

% ------------------------------------------------------------------------------
% Define Test Case Output (tcoC) commands.
%
% Define a command to standardize test case output (tcoC).
\newcommand{\tcoC}[3]{
  %
  \setTOFPathC{#1}{#2} 
  %
  \renewcommand{\tcPathC}{\tofPathC/case}
  \renewcommand{\tcLogC}{\tcPathC/#3/#3.tex}
  \renewcommand{\tcPngC}{\tcPathC/#3/#3-\zerofill{\theFileCnt}.png}
  \renewcommand{\tcCsvC}{\tcPathC/#3/#3.csv}
  %
  \inputIfExists{\tcLogC}
  %
  \setboolean{MoreFiles}{true}
  \whiledo{\boolean{MoreFiles}}{
    \IfFileExists{\tcPngC}{
      \begin{figure}[ht]
        \centering
        \includegraphics[scale=0.25]{\tcPngC}
        \caption{#1 Page}
      \end{figure}
      \addtocounter{FileCnt}{1}
    }
    {\setboolean{MoreFiles}{false}}
  }
  %
  \IfFileExists{\tcCsvC}{
    \csvreader[tcStyle, separator=pipe]
    {\tcCsvC}{}{\id & \key & \des & \status}
  }
  {}
}
% ------------------------------------------------------------------------------